devtools::install_dev_deps()
testthat::test_check()
testthat::test_check(".")
testthat::test_dir("tests")
testthat::test_dir("testthat")
testthat::test_dir("tests")
devtools::test()
devtools::load_all(".")
sim <- vrc_simulate(R = 5, T = 24, t0 = 12, seed = 1)
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>",
message = FALSE,
warning = FALSE
)
base <- vrc_simulate(R = 5, T = 48, t0 = 20, seed = 1, missing = list(type = "none"))
block <- vrc_simulate(R = 5, T = 48, t0 = 20, seed = 1, missing = list(type = "block", block_intercept = -1.5))
devtools::load_all(".")
block <- vrc_simulate(R = 5, T = 48, t0 = 20, seed = 1, missing = list(type = "block", block_intercept = -1.5))
block_drop
stats::runif(1)
p
lin
missing$block_intercept
missing$block_conflict_coef
devtools::load_all(".")
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>",
message = FALSE,
warning = FALSE
)
block <- vrc_simulate(R = 5, T = 48, t0 = 20, seed = 1, missing = list(type = "block", block_intercept = -1.5))
rstan:::as.matrix.stanfit
as.matrix
fitted
qlogis
stats::fitted
# 1) Simulate data
sim <- vrc_simulate(T = 96, t0 = 40, seed = 123)
# Optional: diagnose reporting artefacts before fitting
diag <- vrc_diagnose_reporting(sim$df_obs, t0 = sim$meta$t0)
# 2) Build Stan data and fit
fit <- vrc_fit(
data = sim$df_obs,
t0 = sim$meta$t0,
mortality_covariates = ~ facility,   # example
reporting_covariates = ~ facility,   # example
algorithm = "sampling",
chains = 4,
iter = 1000,
seed = 123
)
sim <- vrc_simulate(R = 2, T = 6, t0 = 3, seed = 1)
out <- vrc_fit(
data = sim$df_obs,
t0 = 3,
mortality_covariates = ~ facility,
reporting_covariates = ~ facility,
chains = 0
)
diag$plots$by_cause
# 2) Build Stan data and fit
fit <- vrc_fit(
data = sim$df_obs,
t0 = sim$meta$t0,
mortality_covariates = ~ facility,   # example
reporting_covariates = ~ facility,   # example
algorithm = "sampling",
chains = 4,
iter = 1000,
seed = 123
)
sim$meta$t0
# Or, using the high-level interface:
mort <- vrc_mortality(~ facility)
rep <- vrc_reporting(~ facility)
mort
rep
# Optional: allow the conflict effect to vary by region (partial pooling)
# and add region-specific time trends around the national random walk.
# This can help prevent spurious "conflict reduces mortality" artefacts when
# reporting collapses differently across regions.
mort2 <- vrc_mortality(~ facility, conflict = "region", time = "region")
rep2  <- vrc_reporting(~ facility, conflict = "region", time = "region")
fit2 <- vrcm(
mortality = mort,
reporting = rep,
data = sim$df_obs,
t0 = sim$meta$t0,
chains = 4,
iter = 1000,
seed = 123
)
fit3 <- vrcm(
mortality = mort2,
reporting = rep2,
data = sim$df_obs,
t0 = sim$meta$t0,
chains = 4,
iter = 1000,
seed = 123
)
# 3) Summarise and plot reporting completeness
summary(fit)
plot_reporting(fit)
library(vrcmort)
# 1) Simulate data
sim <- vrc_simulate(T = 96, t0 = 40, seed = 123)
# Optional: diagnose reporting artefacts before fitting
diag <- vrc_diagnose_reporting(sim$df_obs, t0 = sim$meta$t0)
diag$plots$by_cause
# 2) Build Stan data and fit
fit <- vrc_fit(
data = sim$df_obs,
t0 = sim$meta$t0,
mortality_covariates = ~ facility,   # example
reporting_covariates = ~ facility,   # example
algorithm = "sampling",
chains = 4,
iter = 1000,
seed = 123
)
devtools::load_all(".")
library(vrcmort)
# 1) Simulate data
sim <- vrc_simulate(T = 96, t0 = 40, seed = 123)
# Optional: diagnose reporting artefacts before fitting
diag <- vrc_diagnose_reporting(sim$df_obs, t0 = sim$meta$t0)
diag$plots$by_cause
# 2) Build Stan data and fit
fit <- vrc_fit(
data = sim$df_obs,
t0 = sim$meta$t0,
mortality_covariates = ~ facility,   # example
reporting_covariates = ~ facility,   # example
algorithm = "sampling",
chains = 4,
iter = 1000,
seed = 123
)
devtools::load_all(".")
