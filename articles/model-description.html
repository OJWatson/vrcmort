<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Model Description ‚Ä¢ vrcmort</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Model Description">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">vrcmort</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/OJWatson/vrcmort/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Model Description</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/OJWatson/vrcmort/blob/main/vignettes/model-description.Rmd"><code>vignettes/model-description.Rmd</code></a></small>
      <div class="d-none name"><code>model-description.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p><code>vrcmort</code> implements a hierarchical Bayesian model for
vital registration (VR) mortality counts in settings where the
<em>reporting mechanism changes over time</em>.</p>
<p>The core idea is to distinguish:</p>
<ol style="list-style-type: decimal">
<li>the <strong>latent mortality process</strong> (the deaths that truly
occur), and</li>
<li>the <strong>reporting process</strong> (the probability that those
deaths are recorded in VR).</li>
</ol>
<p>This separation is essential when conflict simultaneously increases
mortality and reduces the completeness of registration.</p>
<p>Throughout this vignette we describe the model in a generative way.
In code, the model is fit in Stan.</p>
</div>
<div class="section level2">
<h2 id="notation-and-indices">Notation and indices<a class="anchor" aria-label="anchor" href="#notation-and-indices"></a>
</h2>
<p>We index:</p>
<ul>
<li>region by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>‚àà</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><mi>R</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">r \in \{1, \ldots, R\}</annotation></semantics></math>
</li>
<li>time (usually month) by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>‚àà</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><mi>T</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">t \in \{1, \ldots, T\}</annotation></semantics></math>
</li>
<li>age group by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>‚àà</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><mi>A</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">a \in \{1, \ldots, A\}</annotation></semantics></math>
</li>
<li>sex by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>‚àà</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><mi>S</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">s \in \{1, \ldots, S\}</annotation></semantics></math>
</li>
<li>cause group by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo>‚àà</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><mi>G</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">g \in \{1, \ldots, G\}</annotation></semantics></math>
</li>
</ul>
<p>For many conflict applications you will start with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">G=2</annotation></semantics></math>:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">g=1</annotation></semantics></math>:
trauma / violence-related</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">g=2</annotation></semantics></math>:
non-trauma</li>
</ul>
<p>The model is written at the cell level
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>r</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>g</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(r,t,a,s,g)</annotation></semantics></math>
and the R interface expects the data to be aggregated into this long
format.</p>
</div>
<div class="section level2">
<h2 id="observed-data">Observed data<a class="anchor" aria-label="anchor" href="#observed-data"></a>
</h2>
<p>For each cell we observe:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mrow><mi>r</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>g</mi></mrow></msub><annotation encoding="application/x-tex">Y_{r,t,a,s,g}</annotation></semantics></math>:
the number of deaths recorded in VR</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mrow><mi>r</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow></msub><annotation encoding="application/x-tex">E_{r,t,a,s}</annotation></semantics></math>:
the exposure (person-time at risk)</li>
</ul>
<p>We also observe region-time covariates. Two are central:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mrow><mi>r</mi><mo>,</mo><mi>t</mi></mrow></msub><annotation encoding="application/x-tex">x_{r,t}</annotation></semantics></math>:
a conflict intensity proxy</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>z</mi><mrow><mi>r</mi><mo>,</mo><mi>t</mi></mrow></msub><annotation encoding="application/x-tex">z_{r,t}</annotation></semantics></math>:
a health system functioning proxy (for example, facility
availability)</li>
</ul>
<p>Additional covariates can be added in the mortality submodel and/or
the reporting submodel.</p>
<div class="section level3">
<h3 id="exposure">Exposure<a class="anchor" aria-label="anchor" href="#exposure"></a>
</h3>
<p>Exposure is whatever scale makes your rates interpretable and
comparable across cells.</p>
<ul>
<li>If you work with month-level counts and every month is fully
covered, you can use
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mrow><mi>r</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow></msub><mo>=</mo><msub><mi>N</mi><mrow><mi>r</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">E_{r,t,a,s} = N_{r,t,a,s}</annotation></semantics></math>
(population).</li>
<li>If periods have different lengths, or if VR was operational for only
part of a period, you can use person-time, for example
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mrow><mi>r</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow></msub><mo>=</mo><msub><mi>N</mi><mrow><mi>r</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow></msub><mo>√ó</mo><mtext mathvariant="normal">days_covered</mtext></mrow><annotation encoding="application/x-tex">E_{r,t,a,s} = N_{r,t,a,s} \times \text{days\_covered}</annotation></semantics></math>.</li>
</ul>
<p>In <code>vrcmort</code> the expected count is proportional to
exposure.</p>
</div>
</div>
<div class="section level2">
<h2 id="latent-mortality-process">Latent mortality process<a class="anchor" aria-label="anchor" href="#latent-mortality-process"></a>
</h2>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œª</mi><mrow><mi>r</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>g</mi></mrow></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\lambda_{r,t,a,s,g} &gt; 0</annotation></semantics></math>
be the <strong>true death rate</strong> (per unit exposure) in a
cell.</p>
<p>A simple generative story is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mrow><mi>r</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>g</mi></mrow></msub><mo>‚à£</mo><msub><mi>Œª</mi><mrow><mi>r</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>g</mi></mrow></msub><mo>‚àº</mo><mtext mathvariant="normal">Poisson</mtext><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">(</mo><msub><mi>E</mi><mrow><mi>r</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow></msub><mo>‚ãÖ</mo><msub><mi>Œª</mi><mrow><mi>r</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>g</mi></mrow></msub><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">)</mo><mo>,</mo></mrow><annotation encoding="application/x-tex">
D_{r,t,a,s,g} \mid \lambda_{r,t,a,s,g} \sim \text{Poisson}\big(E_{r,t,a,s} \cdot \lambda_{r,t,a,s,g}\big),
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>D</mi><mrow><mi>r</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>g</mi></mrow></msub><annotation encoding="application/x-tex">D_{r,t,a,s,g}</annotation></semantics></math>
is the number of true deaths.</p>
<p>In practice, VR counts often show more variation than a Poisson
model. <code>vrcmort</code> therefore uses a negative binomial
observation model (see below), which can be understood as a Poisson
model with extra over-dispersion.</p>
<div class="section level3">
<h3 id="log-linear-model-for-the-rate">Log-linear model for the rate<a class="anchor" aria-label="anchor" href="#log-linear-model-for-the-rate"></a>
</h3>
<p>We model the log rate as a structured additive predictor:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><msub><mi>Œª</mi><mrow><mi>r</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>g</mi></mrow></msub><mo>=</mo><msub><mi>Œ±</mi><mrow><mn>0</mn><mo>,</mo><mi>g</mi></mrow></msub><mo>+</mo><msubsup><mi>Œ±</mi><mrow><mi>a</mi><mo>,</mo><mi>g</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mi>g</mi><mi>e</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>+</mo><msubsup><mi>Œ±</mi><mrow><mi>s</mi><mo>,</mo><mi>g</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mi>e</mi><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>+</mo><msubsup><mi>u</mi><mrow><mi>r</mi><mo>,</mo><mi>g</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œª</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>+</mo><msubsup><mi>v</mi><mrow><mi>t</mi><mo>,</mo><mi>g</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œª</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>+</mo><msub><mi>Œ≤</mi><mrow><mi>c</mi><mi>o</mi><mi>n</mi><mi>f</mi><mo>,</mo><mi>g</mi></mrow></msub><mspace width="0.167em"></mspace><msub><mi>x</mi><mrow><mi>r</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>+</mo><msubsup><mi>ùê±</mi><mrow><mi>r</mi><mo>,</mo><mi>t</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mi>o</mi><mi>r</mi><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><msup><mrow></mrow><mi>‚ä§</mi></msup><msubsup><mi>ùõÉ</mi><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mi>o</mi><mi>r</mi><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mi>.</mi></mrow><annotation encoding="application/x-tex">
\log \lambda_{r,t,a,s,g} = \alpha_{0,g} + \alpha^{(age)}_{a,g} + \alpha^{(sex)}_{s,g} + u^{(\lambda)}_{r,g} + v^{(\lambda)}_{t,g} + \beta_{conf,g} \, x_{r,t} + \mathbf{x}^{(mort)}_{r,t}{}^\top \boldsymbol{\beta}^{(mort)}_{g}.
</annotation></semantics></math></p>
<p>Interpretation of terms:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œ±</mi><mrow><mn>0</mn><mo>,</mo><mi>g</mi></mrow></msub><annotation encoding="application/x-tex">\alpha_{0,g}</annotation></semantics></math>:
baseline log rate for cause
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>
</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>Œ±</mi><mrow><mi>a</mi><mo>,</mo><mi>g</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mi>g</mi><mi>e</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">\alpha^{(age)}_{a,g}</annotation></semantics></math>:
age pattern for cause
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>
</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>Œ±</mi><mrow><mi>s</mi><mo>,</mo><mi>g</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mi>e</mi><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">\alpha^{(sex)}_{s,g}</annotation></semantics></math>:
sex effect for cause
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>
</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>u</mi><mrow><mi>r</mi><mo>,</mo><mi>g</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œª</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">u^{(\lambda)}_{r,g}</annotation></semantics></math>:
region random intercept (partial pooling)</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>v</mi><mrow><mi>t</mi><mo>,</mo><mi>g</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œª</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">v^{(\lambda)}_{t,g}</annotation></semantics></math>:
national time random walk (smooth temporal variation)</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œ≤</mi><mrow><mi>c</mi><mi>o</mi><mi>n</mi><mi>f</mi><mo>,</mo><mi>g</mi></mrow></msub><annotation encoding="application/x-tex">\beta_{conf,g}</annotation></semantics></math>:
effect of conflict intensity on the true rate</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>ùõÉ</mi><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mi>o</mi><mi>r</mi><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">\boldsymbol{\beta}^{(mort)}_{g}</annotation></semantics></math>:
additional mortality covariate effects</li>
</ul>
<p>The conflict effect in the default model is constrained to be
non-negative:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œ≤</mi><mrow><mi>c</mi><mi>o</mi><mi>n</mi><mi>f</mi><mo>,</mo><mi>g</mi></mrow></msub><mo>‚â•</mo><mn>0</mn><mi>.</mi></mrow><annotation encoding="application/x-tex">
\beta_{conf,g} \ge 0.
</annotation></semantics></math></p>
<p>This is a deliberate guardrail against the common artefact where a
regression on observed VR counts concludes that conflict reduces
mortality.</p>
</div>
</div>
<div class="section level2">
<h2 id="reporting-process-registration-completeness">Reporting process (registration completeness)<a class="anchor" aria-label="anchor" href="#reporting-process-registration-completeness"></a>
</h2>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>œÅ</mi><mrow><mi>r</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>g</mi></mrow></msub><mo>‚àà</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\rho_{r,t,a,s,g} \in (0,1)</annotation></semantics></math>
be the probability that a true death in a cell is recorded in VR.</p>
<p>A natural generative step is binomial thinning:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>Y</mi><mrow><mi>r</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>g</mi></mrow><mo>*</mo></msubsup><mo>‚à£</mo><msub><mi>D</mi><mrow><mi>r</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>g</mi></mrow></msub><mo>,</mo><msub><mi>œÅ</mi><mrow><mi>r</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>g</mi></mrow></msub><mo>‚àº</mo><mtext mathvariant="normal">Binomial</mtext><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">(</mo><msub><mi>D</mi><mrow><mi>r</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>g</mi></mrow></msub><mo>,</mo><mspace width="0.167em"></mspace><msub><mi>œÅ</mi><mrow><mi>r</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>g</mi></mrow></msub><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">)</mo><mo>,</mo></mrow><annotation encoding="application/x-tex">
Y^\ast_{r,t,a,s,g} \mid D_{r,t,a,s,g}, \rho_{r,t,a,s,g} \sim \text{Binomial}\big(D_{r,t,a,s,g},\, \rho_{r,t,a,s,g}\big),
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>Y</mi><mo>*</mo></msup><annotation encoding="application/x-tex">Y^\ast</annotation></semantics></math>
would be the number of observed deaths if causes were perfectly
classified. In the base model we do not explicitly model
misclassification; instead we recommend starting with robust cause
groupings (for example trauma vs non-trauma).</p>
<div class="section level3">
<h3 id="logistic-model-for-completeness">Logistic model for completeness<a class="anchor" aria-label="anchor" href="#logistic-model-for-completeness"></a>
</h3>
<p>We model the logit of completeness:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">logit</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>œÅ</mi><mrow><mi>r</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>g</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>Œ∫</mi><mrow><mn>0</mn><mo>,</mo><mi>g</mi></mrow></msub><mo>+</mo><msub><mi>Œ∫</mi><mrow><mi>p</mi><mi>o</mi><mi>s</mi><mi>t</mi><mo>,</mo><mi>g</mi></mrow></msub><mo>‚ãÖ</mo><msub><mtext mathvariant="normal">post</mtext><mi>t</mi></msub><mo>+</mo><msubsup><mi>u</mi><mrow><mi>r</mi><mo>,</mo><mi>g</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>œÅ</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>+</mo><msubsup><mi>v</mi><mrow><mi>t</mi><mo>,</mo><mi>g</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>œÅ</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>+</mo><msub><mi>Œ≥</mi><mrow><mi>c</mi><mi>o</mi><mi>n</mi><mi>f</mi><mo>,</mo><mi>g</mi></mrow></msub><mspace width="0.167em"></mspace><msub><mi>x</mi><mrow><mi>r</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>+</mo><msubsup><mi>ùê±</mi><mrow><mi>r</mi><mo>,</mo><mi>t</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>r</mi><mi>e</mi><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><msup><mrow></mrow><mi>‚ä§</mi></msup><msubsup><mi>ùõÑ</mi><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>r</mi><mi>e</mi><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>+</mo><mtext mathvariant="normal">agepen</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>g</mi><mo>,</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
\text{logit}(\rho_{r,t,a,s,g}) = \kappa_{0,g} + \kappa_{post,g} \cdot \text{post}_t + u^{(\rho)}_{r,g} + v^{(\rho)}_{t,g} + \gamma_{conf,g} \, x_{r,t} + \mathbf{x}^{(rep)}_{r,t}{}^\top \boldsymbol{\gamma}^{(rep)}_{g} + \text{agepen}(a,g,t).
</annotation></semantics></math></p>
<p>Key pieces:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œ∫</mi><mrow><mn>0</mn><mo>,</mo><mi>g</mi></mrow></msub><annotation encoding="application/x-tex">\kappa_{0,g}</annotation></semantics></math>:
baseline completeness (pre-conflict) for cause
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>
</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œ∫</mi><mrow><mi>p</mi><mi>o</mi><mi>s</mi><mi>t</mi><mo>,</mo><mi>g</mi></mrow></msub><annotation encoding="application/x-tex">\kappa_{post,g}</annotation></semantics></math>:
a shift in completeness after conflict begins</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>u</mi><mrow><mi>r</mi><mo>,</mo><mi>g</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>œÅ</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">u^{(\rho)}_{r,g}</annotation></semantics></math>:
region random intercept for completeness</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>v</mi><mrow><mi>t</mi><mo>,</mo><mi>g</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>œÅ</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">v^{(\rho)}_{t,g}</annotation></semantics></math>:
national time random walk for completeness</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œ≥</mi><mrow><mi>c</mi><mi>o</mi><mi>n</mi><mi>f</mi><mo>,</mo><mi>g</mi></mrow></msub><annotation encoding="application/x-tex">\gamma_{conf,g}</annotation></semantics></math>:
effect of conflict on completeness</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>ùõÑ</mi><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>r</mi><mi>e</mi><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">\boldsymbol{\gamma}^{(rep)}_{g}</annotation></semantics></math>:
additional reporting covariate effects</li>
</ul>
<p>The indicator
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="normal">post</mtext><mi>t</mi></msub><annotation encoding="application/x-tex">\text{post}_t</annotation></semantics></math>
is 0 before the conflict start time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>0</mn></msub><annotation encoding="application/x-tex">t_0</annotation></semantics></math>
and 1 afterwards.</p>
</div>
<div class="section level3">
<h3 id="age-selective-reporting-collapse">Age-selective reporting collapse<a class="anchor" aria-label="anchor" href="#age-selective-reporting-collapse"></a>
</h3>
<p>A distinctive feature of conflict VR data is that completeness can
become age-selective: older deaths (especially non-trauma) drop out of
the system.</p>
<p><code>vrcmort</code> represents this with an age penalty applied
after conflict starts, typically only for non-trauma causes:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">agepen</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>g</mi><mo>,</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>‚àí</mo><msub><mi>Œ¥</mi><mi>a</mi></msub><mo>‚ãÖ</mo><mn>ùüô</mn><mrow><mo stretchy="true" form="prefix">[</mo><mi>g</mi><mo>=</mo><mtext mathvariant="normal">non-trauma</mtext><mo stretchy="true" form="postfix">]</mo></mrow><mo>‚ãÖ</mo><msub><mtext mathvariant="normal">post</mtext><mi>t</mi></msub><mo>,</mo></mrow><annotation encoding="application/x-tex">
\text{agepen}(a,g,t) = - \delta_a \cdot \mathbb{1}[g = \text{non-trauma}] \cdot \text{post}_t,
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œ¥</mi><mi>a</mi></msub><mo>‚â•</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\delta_a \ge 0</annotation></semantics></math>
is a monotone non-decreasing function of age group. In the Stan model
this is implemented by modelling positive increments between age
groups.</p>
<p>The result is that, after conflict begins, the model allows the
observed VR age distribution to shift younger even when the underlying
mortality age schedule remains broadly similar.</p>
</div>
</div>
<div class="section level2">
<h2 id="observation-model-for-vr-counts">Observation model for VR counts<a class="anchor" aria-label="anchor" href="#observation-model-for-vr-counts"></a>
</h2>
<p>The model used for fitting is a negative binomial likelihood on the
observed counts:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mrow><mi>r</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>g</mi></mrow></msub><mo>‚àº</mo><mtext mathvariant="normal">NegBin2</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Œº</mi><mrow><mi>r</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>g</mi></mrow></msub><mo>,</mo><mspace width="0.167em"></mspace><msub><mi>œï</mi><mi>g</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
Y_{r,t,a,s,g} \sim \text{NegBin2}(\mu_{r,t,a,s,g},\, \phi_g),
</annotation></semantics></math></p>
<p>with</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œº</mi><mrow><mi>r</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>g</mi></mrow></msub><mo>=</mo><msub><mi>E</mi><mrow><mi>r</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi></mrow></msub><mo>‚ãÖ</mo><msub><mi>Œª</mi><mrow><mi>r</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>g</mi></mrow></msub><mo>‚ãÖ</mo><msub><mi>œÅ</mi><mrow><mi>r</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>g</mi></mrow></msub><mi>.</mi></mrow><annotation encoding="application/x-tex">
\mu_{r,t,a,s,g} = E_{r,t,a,s} \cdot \lambda_{r,t,a,s,g} \cdot \rho_{r,t,a,s,g}.
</annotation></semantics></math></p>
<p>The parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>œï</mi><mi>g</mi></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\phi_g &gt; 0</annotation></semantics></math>
is a cause-specific dispersion parameter.</p>
<p>This single likelihood implicitly marginalises over the latent true
deaths
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>D</mi><annotation encoding="application/x-tex">D</annotation></semantics></math>.
You can still interpret the model generatively as ‚Äútrue deaths occur‚Äù
then ‚Äúsome are recorded‚Äù.</p>
</div>
<div class="section level2">
<h2 id="identifiability-and-anchoring">Identifiability and anchoring<a class="anchor" aria-label="anchor" href="#identifiability-and-anchoring"></a>
</h2>
<p>From the likelihood alone,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œª</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÅ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>
are only weakly identified because they appear as a product
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œª</mi><mo>‚ãÖ</mo><mi>œÅ</mi></mrow><annotation encoding="application/x-tex">\lambda \cdot \rho</annotation></semantics></math>.</p>
<p><code>vrcmort</code> uses several sources of information to separate
them:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Pre-conflict behaviour</strong>: if VR looks stable
pre-conflict, it is reasonable to place informative priors on baseline
completeness
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œ∫</mi><mrow><mn>0</mn><mo>,</mo><mi>g</mi></mrow></msub><annotation encoding="application/x-tex">\kappa_{0,g}</annotation></semantics></math>.</li>
<li>
<strong>Age structure</strong>: age-selective collapse is
informative about reporting rather than mortality.</li>
<li>
<strong>Smoothness</strong>: random walk priors on time effects
discourage implausibly sharp swings in the latent mortality rate.</li>
<li>
<strong>Covariate separation</strong>: covariates believed to
reflect system functioning are more naturally placed in the reporting
model than the mortality model.</li>
</ol>
<p>The priors are therefore not an afterthought; they are part of what
makes inference possible.</p>
</div>
<div class="section level2">
<h2 id="extensions-supported-in-the-current-base-model">Extensions supported in the current base model<a class="anchor" aria-label="anchor" href="#extensions-supported-in-the-current-base-model"></a>
</h2>
<p>The base Stan program shipped with <code>vrcmort</code> includes
optional structured extensions controlled by the R interface:</p>
<ul>
<li>
<strong>Region-varying conflict effects</strong>: partial pooling
for the conflict coefficient by region.</li>
<li>
<strong>Region-specific time trends</strong>: region-specific random
walks around a national trend.</li>
</ul>
<p>Other extensions (misclassification between cause groups, population
uncertainty, additional observation streams) can be added by extending
the Stan components. The vignette on implementation explains how the
Stan code is modularised.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by OJ Watson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
